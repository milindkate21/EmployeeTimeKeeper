<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Reports</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css"
    />

    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/buttons/2.1.1/css/buttons.dataTables.min.css"
    />

    <!-- Font Awesome CDN for icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/Css/navbar.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.1.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.1.1/js/buttons.html5.min.js"></script>
    <script type="module" src="/Scripts/firebase.js" defer></script>
    <script type="module" src="/Scripts/common.js"></script>
    <style>
      #timecard-table {
        margin-top: 20px;
        width: 100%;
      }

      .center {
        display: flex;
        justify-content: center;
      }

      .mt-3 {
        margin-top: 20px;
      }

      .toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      /* Style for entries dropdown */
      .dataTables_length label {
        margin-bottom: 0;
      }

      /* Style the Export to Excel button */
      .dataTables_wrapper .dt-buttons {
        margin-bottom: 0;
        float: right;
        margin: 0px 10px;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img
            src="/Images/logo.png"
            alt="Company Logo"
            class="d-inline-block align-text-top"
          />
          <span>Dragonfly Services</span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/Pages/Home.html">
                <i class="fas fa-home"></i>Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/Pages/EmployeeHome.html">
                <i class="fas fa-user"></i>Employee Form</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/Pages/Reports.html">
                <i class="fas fa-chart-bar"></i>Report</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/Pages/Login.html" id="signOut">
                <i class="fas fa-sign-out-alt"></i>Sign Out</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container mt-5">
      <h3 class="text-center">Daily Time Card Reports</h3>
      <div class="row mt-3 center">
        <div class="col-md-4">
          <label for="dateField" class="form-label">Date</label>
          <div class="input-group">
            <input type="text" class="form-control" id="dateField" readonly />
          </div>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-md-12">
          <table id="timecardTable" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Name</th>
                <th>Service Order Number</th>
                <th>Date</th>
                <th>Time In</th>
                <th>Time Out</th>
                <th>Actual Hours</th>
                <th>Billed Hours</th>
                <th>Rate</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
    <script>
      let data = [
        {
          TechnicianName: "Jim Rosobrough",
          ServiceOrderNumber: "11984",
          Date: "09 May 2024",
          TimeIn: "07:00 AM",
          TimeOut: "08:00 AM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "Fixed floor tiles.",
        },
        {
          TechnicianName: "Jim Rosobrough",
          ServiceOrderNumber: "65712",
          Date: "09 May 2024",
          TimeIn: "08:00 AM",
          TimeOut: "10:00 AM",
          ActualHours: "2.00",
          BilledHours: "2.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Jim Rosobrough",
          ServiceOrderNumber: "65971MT",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "3.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Jim Rosobrough",
          ServiceOrderNumber: "65802",
          Date: "09 May 2024",
          TimeIn: "04:00 PM",
          TimeOut: "05:00 PM",
          ActualHours: "1.00",
          BilledHours: "2.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Jordan",
          ServiceOrderNumber: "11984",
          Date: "09 May 2024",
          TimeIn: "07:00 AM",
          TimeOut: "08:00 AM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "Helps to fix pipeline from first floor.",
        },
        {
          TechnicianName: "Jordan",
          ServiceOrderNumber: "65712",
          Date: "09 May 2024",
          TimeIn: "08:00 AM",
          TimeOut: "10:00 AM",
          ActualHours: "2.00",
          BilledHours: "2.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Jordan",
          ServiceOrderNumber: "65791MT",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Virat",
          ServiceOrderNumber: "65791MT",
          Date: "08 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "Testing of front slides.",
        },
        //-----------------------------------
        {
          TechnicianName: "Head",
          ServiceOrderNumber: "61234",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Matt",
          ServiceOrderNumber: "65001",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Tesla",
          ServiceOrderNumber: "65101",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "",
        },
        {
          TechnicianName: "Mike",
          ServiceOrderNumber: "65791MT",
          Date: "09 May 2024",
          TimeIn: "10:00 AM",
          TimeOut: "01:00 PM",
          ActualHours: "1.00",
          BilledHours: "1.00",
          Rate: "Reg",
          Notes: "",
        },
      ];

      $(document).ready(function () {
        var table = $("#timecardTable").DataTable({
          responsive: true,
          scrollY: "400px",
          scrollCollapse: true,
          scroller: true,
          //dom: "Bfrtip", // Add the 'B' option to include buttons
          dom: 'l<"toolbar">Bfrtip',
          buttons: [
            {
              extend: "excelHtml5",
              text: "Excel",
              filename: "Timecard Report",
              exportOptions: {
                columns: ":visible",
              },
            },
          ],
        });

        function populateTable(selectedDate) {
          table.clear().draw();
          data.forEach((record) => {
            if (record.Date === selectedDate) {
              table.row
                .add([
                  record.TechnicianName,
                  record.ServiceOrderNumber,
                  record.Date,
                  record.TimeIn,
                  record.TimeOut,
                  record.ActualHours,
                  record.BilledHours,
                  record.Rate,
                  record.Notes,
                ])
                .draw(false);
            }
          });
        }

        $("#dateField").datepicker({
          showOn: "both",
          buttonText: '<i class="bi bi-calendar3"></i>',
          dateFormat: "dd MM yy",
          maxDate: 0,
          onSelect: function (dateText) {
            populateTable(dateText);
          },
        });

        let currentDate = new Date();
        let day = currentDate.getDate().toString().padStart(2, "0");
        let month = currentDate.toLocaleString("default", { month: "long" });
        let year = currentDate.getFullYear().toString(); //.slice(-2)

        let formattedDate = `${day} ${month} ${year}`;
        $("#dateField").datepicker("setDate", currentDate);
        populateTable(formattedDate);
      });
    </script>
  </body>
</html>
